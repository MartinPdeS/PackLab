
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "gallery/mono_disperse.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_gallery_mono_disperse.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gallery_mono_disperse.py:


Polydisperse RSA simulation
===========================

This example demonstrates a Random Sequential Addition (RSA) simulation
with polydisperse spheres. In a polydisperse system, each sphere radius
is sampled from a continuous distribution rather than using a fixed value.

The workflow illustrates:

1. Creating a simulation domain
2. Sampling radii from a uniform distribution
3. Running the simulator with polydispersity
4. Inspecting statistics
5. Plotting a slice of the configuration
6. Computing and displaying the pair correlation function

Polydisperse systems are useful when modelling realistic physical packings,
microstructures, or biological particle systems with non uniform sizes.

.. GENERATED FROM PYTHON SOURCE LINES 23-26

Simulation domain
-----------------
We create a cube with periodic boundaries.

.. GENERATED FROM PYTHON SOURCE LINES 26-36

.. code-block:: Python


    from PackLab import Domain, Options, Simulator, UniformRadiusSampler

    domain = Domain(
        length_x=6.0,
        length_y=6.0,
        length_z=6.0,
        use_periodic_boundaries=True
    )








.. GENERATED FROM PYTHON SOURCE LINES 37-41

Polydisperse radius sampler
---------------------------
Radii are drawn from a uniform distribution between 0.1 and 0.4.
This gives a wide range of sphere sizes.

.. GENERATED FROM PYTHON SOURCE LINES 41-47

.. code-block:: Python


    radius_sampler = UniformRadiusSampler(
        minimum_radius=0.1,
        maximum_radius=0.4
    )








.. GENERATED FROM PYTHON SOURCE LINES 48-52

Simulation options
------------------
We increase the number of attempts since small spheres will continue
to find space even when the large ones are already rejected.

.. GENERATED FROM PYTHON SOURCE LINES 52-60

.. code-block:: Python


    options = Options()
    options.random_seed = 42
    options.maximum_attempts = 4_000_000
    options.maximum_consecutive_rejections = 80_000
    options.target_packing_fraction = 0.55
    options.minimum_center_separation_addition = 0.0








.. GENERATED FROM PYTHON SOURCE LINES 61-63

Run the polydisperse RSA simulation
-----------------------------------

.. GENERATED FROM PYTHON SOURCE LINES 63-72

.. code-block:: Python


    rsa_simulator = Simulator(
        domain=domain,
        radius_sampler=radius_sampler,
        options=options
    )

    result = rsa_simulator.run()








.. GENERATED FROM PYTHON SOURCE LINES 73-75

Inspect simulation statistics
-----------------------------

.. GENERATED FROM PYTHON SOURCE LINES 75-78

.. code-block:: Python


    result.statistics.print()








.. GENERATED FROM PYTHON SOURCE LINES 79-83

Plot a slice of the configuration
---------------------------------
This gives a quick visual impression of the spatial structure,
which is more complex than in the monodisperse case.

.. GENERATED FROM PYTHON SOURCE LINES 83-86

.. code-block:: Python


    result.plot_slice_2d()




.. image-sg:: /gallery/images/sphx_glr_mono_disperse_001.png
   :alt: 2D slice at zâ‰ˆ3.00, thickness 0.48 | showing 532 spheres
   :srcset: /gallery/images/sphx_glr_mono_disperse_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/MPSPlots/helper.py:77: UserWarning: Glyph 8776 (\N{ALMOST EQUAL TO}) missing from font(s) cmr10.
      figure.tight_layout()

    <Figure size 800x500 with 1 Axes>



.. GENERATED FROM PYTHON SOURCE LINES 87-91

Pair correlation function
-------------------------
Compute and plot the pair correlation function g(r)
for the polydisperse configuration.

.. GENERATED FROM PYTHON SOURCE LINES 91-93

.. code-block:: Python


    result.plot_pair_correlation(maximum_number_of_pairs=3_000_000)



.. image-sg:: /gallery/images/sphx_glr_mono_disperse_002.png
   :alt: Pair correlation function (minimum image)
   :srcset: /gallery/images/sphx_glr_mono_disperse_002.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <Figure size 800x500 with 1 Axes>




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 14.169 seconds)


.. _sphx_glr_download_gallery_mono_disperse.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: mono_disperse.ipynb <mono_disperse.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: mono_disperse.py <mono_disperse.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: mono_disperse.zip <mono_disperse.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
